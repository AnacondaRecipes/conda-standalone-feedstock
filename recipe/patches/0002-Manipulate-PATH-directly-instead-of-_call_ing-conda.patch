From a1b3edbdcccaec30ab92a4f0beb52e49606cf358 Mon Sep 17 00:00:00 2001
From: Nehal J Wani <nehaljw.kkd1@gmail.com>
Date: Tue, 13 Aug 2019 07:46:10 -0400
Subject: [PATCH 2/3] Manipulate PATH directly instead of _call_ing conda.bat

---
 conda/utils.py | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/conda/utils.py b/conda/utils.py
index b9a3cc5cc..5f3e29c5c 100644
--- a/conda/utils.py
+++ b/conda/utils.py
@@ -438,7 +438,16 @@ def wrap_subprocess_call(
             # after all!
             # fh.write("@FOR /F \"tokens=100\" %%F IN ('chcp') DO @SET CONDA_OLD_CHCP=%%F\n")
             # fh.write('@chcp 65001>NUL\n')
-            fh.write(f'{silencer}CALL "{conda_bat}" activate "{prefix}"\n')
+            # fh.write(f'{silencer}CALL "{conda_bat}" activate "{prefix}"\n')
+            fh.write(
+                f'SET "PATH={prefix};'
+                f'{prefix}\\Library\\mingw-w64\\bin;'
+                f'{prefix}\\Library\\usr\\bin;'
+                f'{prefix}\\Library\\bin;'
+                f'{prefix}\\Scripts;'
+                f'{prefix}\\bin;'
+                '%PATH%"'
+            )
             fh.write(f"{silencer}IF %ERRORLEVEL% NEQ 0 EXIT /b %ERRORLEVEL%\n")
             if debug_wrapper_scripts:
                 fh.write("echo *** environment after *** 1>&2\n")
--
2.32.1 (Apple Git-133)

